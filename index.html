<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Water Status Monitor</title>

<style>
    body {
        margin : 0;
        font-family: Arial, sans-serif;
        text-align: center;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 3em;
        font-weight: bold;
        transition: background-color 0.5s ease;
    }
</style>
</head>
<body id="statusBody">
    <div id="statusText">Loading...</div>

<script>
const channelID = "3036096"; // Your ThingSpeak Channel ID
const readAPIKey = "M1SKX47JKTS0EUA4"; // Your ThingSpeak Read API Key
const fieldNum = 1; // Which field stores the water status
const fetchInterval = 5000; // Check every 5 seconds

function fetchData() {
    fetch(`https://api.thingspeak.com/channels/${channelID}/fields/${fieldNum}/last.json?api_key=${readAPIKey}`)
    .then(response => response.json())
    .then(data => {
        let value = parseInt(data.field1);
        updateStatus(value);
    })
    .catch(error => {
        console.error("Error fetching data:", error);
        document.getElementById("statusText").innerText = "Error!";
        document.getElementById("statusBody").style.backgroundColor = "gray";
    });
}

function updateStatus(value) {
    let statusText = document.getElementById("statusText");
    let body = document.getElementById("statusBody");

    if (value === 1) {
        statusText.innerText = "ðŸš« NOT SAFE";
        body.style.backgroundColor = "red";
    } else if (value === 2) {
        statusText.innerText = "âœ… SAFE";
        body.style.backgroundColor = "green";
    } else if (value === 3) {
        statusText.innerText = "âš™ PROCESSING";
        body.style.backgroundColor = "blue";
    } else {
        statusText.innerText = "No Data";
        body.style.backgroundColor = "gray";
    }
}

// First fetch instantly
fetchData();
// Keep updating
setInterval(fetchData, fetchInterval);
</script>
</body>
</html>
